[gd_scene load_steps=12 format=3 uid="uid://dhnntcfxs4lg0"]

[ext_resource type="PackedScene" path="res://scenes/Paddle.tscn" id="1"]
[ext_resource type="Script" uid="uid://b8nul2np1du6b" path="res://scripts/Main.gd" id="3"]
[ext_resource type="PackedScene" uid="uid://cfnto8it2e26m" path="res://scenes/Shop.tscn" id="4"]
[ext_resource type="Script" uid="uid://bncgwbo12t5vj" path="res://scripts/ui/MapGraph.gd" id="5"]

[sub_resource type="RectangleShape2D" id="1"]
size = Vector2(20, 600)

[sub_resource type="RectangleShape2D" id="2"]
size = Vector2(800, 20)

[node name="Main" type="Node2D"]
script = ExtResource("3")

[node name="Backdrop" type="CanvasLayer" parent="."]
layer = -10

[node name="BackdropRect" type="ColorRect" parent="Backdrop"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
color = Color(0.08, 0.08, 0.1, 1)

[node name="Playfield" type="Polygon2D" parent="."]
color = Color(0.16, 0.16, 0.18, 1)

[node name="Paddle" parent="." instance=ExtResource("1")]
position = Vector2(400, 386)

[node name="Bricks" type="Node2D" parent="."]

[node name="Walls" type="StaticBody2D" parent="."]

[node name="LeftWall" type="CollisionShape2D" parent="Walls"]
position = Vector2(-10, 300)
shape = SubResource("1")

[node name="RightWall" type="CollisionShape2D" parent="Walls"]
position = Vector2(810, 300)
shape = SubResource("1")

[node name="TopWall" type="CollisionShape2D" parent="Walls"]
position = Vector2(400, -10)
shape = SubResource("2")

[node name="HUD" type="CanvasLayer" parent="."]

[node name="TopBar" type="HBoxContainer" parent="HUD"]
anchors_preset = 10
anchor_right = 1.0
offset_left = 16.0
offset_top = 12.0
offset_right = -16.0
offset_bottom = 36.0
theme_override_constants/separation = 12

[node name="HpLabel" type="Label" parent="HUD/TopBar"]
layout_mode = 2
text = "HP: 150/150"

[node name="GoldLabel" type="Label" parent="HUD/TopBar"]
layout_mode = 2
text = "Gold: 0"

[node name="EnergyLabel" type="Label" parent="HUD/TopBar"]
layout_mode = 2
text = "Energy: 3/3"

[node name="DeckLabel" type="Label" parent="HUD/TopBar"]
layout_mode = 2
text = "Draw: 0"

[node name="DiscardLabel" type="Label" parent="HUD/TopBar"]
layout_mode = 2
text = "Discard: 0"

[node name="ThreatLabel" type="Label" parent="HUD/TopBar"]
layout_mode = 2
text = "Threat: 0"

[node name="FloorLabel" type="Label" parent="HUD/TopBar"]
layout_mode = 2
text = "Floor 1/6"

[node name="ModsPanel" type="Panel" parent="HUD"]
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -180.0
offset_top = 72.0
offset_right = -16.0
offset_bottom = 273.0
grow_horizontal = 0

[node name="ModsLabel" type="Label" parent="HUD/ModsPanel"]
layout_mode = 0
offset_left = 12.0
offset_top = 10.0
offset_right = 160.0
offset_bottom = 30.0
text = "Ball Mods"

[node name="ModsButtons" type="VBoxContainer" parent="HUD/ModsPanel"]
layout_mode = 0
offset_left = 12.0
offset_top = 36.0
offset_right = 160.0
offset_bottom = 160.0
theme_override_constants/separation = 6

[node name="ModsPersist" type="CheckBox" parent="HUD/ModsPanel"]
layout_mode = 0
offset_left = 10.0
offset_top = 166.0
offset_right = 158.0
offset_bottom = 194.0
tooltip_text = "Re-apply after use (while available)."
theme_override_constants/outline_size = 1
text = "Persist"

[node name="InfoLabel" type="Label" parent="HUD"]
anchors_preset = 10
anchor_right = 1.0
offset_left = 16.0
offset_top = 42.0
offset_right = -16.0
offset_bottom = 62.0
text = "Choose your next room."

[node name="VictoryOverlay" type="ColorRect" parent="HUD"]
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
mouse_filter = 2
color = Color(0.95, 0.85, 0.25, 0.12)
z_index = -1

[node name="DefeatOverlay" type="ColorRect" parent="HUD"]
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
mouse_filter = 2
color = Color(0.3, 0.08, 0.08, 0.18)
z_index = -1

[node name="HandBar" type="Panel" parent="HUD"]
anchors_preset = 12
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 16.0
offset_top = -200.0
offset_right = -16.0
offset_bottom = -10.0

[node name="DeckStack" type="Control" parent="HUD/HandBar"]
anchors_preset = 0
offset_left = 8.0
offset_top = 8.0
offset_right = 136.0
offset_bottom = -8.0

[node name="DeckCardBack1" type="ColorRect" parent="HUD/HandBar/DeckStack"]
layout_mode = 0
offset_left = 12.0
offset_top = 12.0
offset_right = 122.0
offset_bottom = 166.0
color = Color(0.16, 0.16, 0.16, 1)

[node name="DeckCardBack2" type="ColorRect" parent="HUD/HandBar/DeckStack"]
layout_mode = 0
offset_left = 8.0
offset_top = 8.0
offset_right = 118.0
offset_bottom = 162.0
color = Color(0.2, 0.2, 0.2, 1)

[node name="DeckCardBack3" type="ColorRect" parent="HUD/HandBar/DeckStack"]
layout_mode = 0
offset_left = 4.0
offset_top = 4.0
offset_right = 114.0
offset_bottom = 158.0
color = Color(0.24, 0.24, 0.24, 1)

[node name="DeckButton" type="Button" parent="HUD/HandBar/DeckStack"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 3.0
offset_top = 3.0
offset_right = -5.0
offset_bottom = 166.0
grow_horizontal = 2
grow_vertical = 2
flat = true

[node name="HandContainer" type="HBoxContainer" parent="HUD/HandBar"]
layout_mode = 0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 156.0
offset_top = 8.0
offset_right = -156.0
offset_bottom = -8.0
theme_override_constants/separation = 8

[node name="DiscardStack" type="Control" parent="HUD/HandBar"]
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -136.0
offset_top = 8.0
offset_right = -8.0
offset_bottom = 174.0
grow_horizontal = 0

[node name="DiscardCardBack3" type="ColorRect" parent="HUD/HandBar/DiscardStack"]
layout_mode = 0
offset_left = 28.0
offset_top = 2.0
offset_right = 138.0
offset_bottom = 156.0
rotation = 0.174533
color = Color(0.12156863, 0.12156863, 0.12156863, 1)

[node name="DiscardCardBack2" type="ColorRect" parent="HUD/HandBar/DiscardStack"]
layout_mode = 0
offset_left = -4.0
offset_top = 27.0
offset_right = 106.0
offset_bottom = 181.0
rotation = -0.174533
color = Color(0.16, 0.16, 0.16, 1)

[node name="DiscardCardBack1" type="ColorRect" parent="HUD/HandBar/DiscardStack"]
layout_mode = 0
offset_left = 12.0
offset_top = 12.0
offset_right = 122.0
offset_bottom = 166.0
color = Color(0.23921569, 0.23921569, 0.23921569, 1)

[node name="DiscardButton" type="Button" parent="HUD/HandBar/DiscardStack"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 7.0
offset_top = 5.0
offset_right = -1.0
offset_bottom = 7.0
grow_horizontal = 2
grow_vertical = 2
flat = true

[node name="MapPanel" type="Panel" parent="HUD"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -260.0
offset_top = -340.0
offset_right = 260.0
offset_bottom = 259.0
grow_horizontal = 2
grow_vertical = 2

[node name="MapLabel" type="Label" parent="HUD/MapPanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 12.0
offset_right = 520.0
offset_bottom = 32.0
text = "Map"

[node name="MapSeedLabel" type="Label" parent="HUD/MapPanel"]
layout_mode = 0
offset_left = 300.0
offset_top = 12.0
offset_right = 504.0
offset_bottom = 32.0
text = "Seed: -"
horizontal_alignment = 2

[node name="MapGraph" type="Control" parent="HUD/MapPanel"]
anchors_preset = 0
offset_left = 16.0
offset_top = 40.0
offset_right = 520.0
offset_bottom = 500.0
mouse_filter = 1
script = ExtResource("5")

[node name="MapButtons" type="HBoxContainer" parent="HUD/MapPanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 512.0
offset_right = 520.0
offset_bottom = 548.0
theme_override_constants/separation = 12
alignment = 1

[node name="RewardPanel" type="Panel" parent="HUD"]
visible = false
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -240.0
offset_top = -159.0
offset_right = 240.0
offset_bottom = 110.0
grow_horizontal = 2
grow_vertical = 2

[node name="RewardLabel" type="Label" parent="HUD/RewardPanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 12.0
offset_right = 440.0
offset_bottom = 32.0
text = "Choose a card"

[node name="RewardLayout" type="VBoxContainer" parent="HUD/RewardPanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 48.0
offset_right = 440.0
offset_bottom = 180.0
theme_override_constants/separation = 6

[node name="RewardButtons" type="HBoxContainer" parent="HUD/RewardPanel/RewardLayout"]
layout_mode = 2
theme_override_constants/separation = 6

[node name="RewardSkipButton" type="Button" parent="HUD/RewardPanel/RewardLayout"]
layout_mode = 2
text = "Skip"

[node name="TreasurePanel" type="Panel" parent="HUD"]
visible = false
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -220.0
offset_top = -140.0
offset_right = 220.0
offset_bottom = 140.0
grow_horizontal = 2
grow_vertical = 2

[node name="TreasureLabel" type="Label" parent="HUD/TreasurePanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 12.0
offset_right = 408.0
offset_bottom = 32.0
text = "Treasure found"

[node name="TreasureLayout" type="VBoxContainer" parent="HUD/TreasurePanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 48.0
offset_right = 408.0
offset_bottom = 216.0
theme_override_constants/separation = 6

[node name="TreasureRewards" type="VBoxContainer" parent="HUD/TreasurePanel/TreasureLayout"]
layout_mode = 2
theme_override_constants/separation = 4

[node name="TreasureContinueButton" type="Button" parent="HUD/TreasurePanel/TreasureLayout"]
layout_mode = 2
text = "Continue"

[node name="ShopPanel" parent="HUD" instance=ExtResource("4")]
visible = false

[node name="DeckPanel" type="Panel" parent="HUD"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -376.0
offset_top = -264.0
offset_right = 377.0
offset_bottom = 253.0
grow_horizontal = 2
grow_vertical = 2

[node name="DeckLabel" type="Label" parent="HUD/DeckPanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 12.0
offset_right = 440.0
offset_bottom = 32.0
text = "Deck"

[node name="DeckScroll" type="ScrollContainer" parent="HUD/DeckPanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 44.0
offset_right = 735.0
offset_bottom = 460.0

[node name="DeckList" type="VBoxContainer" parent="HUD/DeckPanel/DeckScroll"]
layout_mode = 2
theme_override_constants/separation = 4

[node name="DeckCloseButton" type="Button" parent="HUD/DeckPanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 467.0
offset_right = 160.0
offset_bottom = 498.0
text = "Close"

[node name="GameOverPanel" type="Panel" parent="HUD"]
visible = false
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -180.0
offset_top = -60.0
offset_right = 180.0
offset_bottom = 60.0

[node name="GameOverLabel" type="Label" parent="HUD/GameOverPanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 12.0
offset_right = 340.0
offset_bottom = 32.0
text = "Game Over"

[node name="RestartButton" type="Button" parent="HUD/GameOverPanel"]
layout_mode = 0
offset_left = 16.0
offset_top = 52.0
offset_right = 160.0
offset_bottom = 84.0
text = "Restart Run"

[node name="MenuButton" type="Button" parent="HUD/GameOverPanel"]
layout_mode = 0
offset_left = 180.0
offset_top = 52.0
offset_right = 320.0
offset_bottom = 84.0
text = "Main Menu"

[node name="ForfeitDialog" type="ConfirmationDialog" parent="HUD"]
title = "Forfeit Volley"
ok_button_text = "Forfeit"
dialog_text = "End the volley and take threat damage?"
